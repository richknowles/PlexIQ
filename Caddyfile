# PlexIQ Caddy Configuration

# Add this to your main Caddyfile or use it standalone

 

# Frontend Dashboard

plexiq.oz.alisium.run {

    # Reverse proxy to frontend

    reverse_proxy localhost:8080

 

    # Gzip compression

    encode gzip

 

    # Security headers

    header {

        # Enable HSTS

        Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"

 

        # Prevent clickjacking

        X-Frame-Options "SAMEORIGIN"

 

        # XSS protection

        X-XSS-Protection "1; mode=block"

 

        # Content type sniffing

        X-Content-Type-Options "nosniff"

 

        # Referrer policy

        Referrer-Policy "strict-origin-when-cross-origin"

    }

 

    # Logging

    log {

        output file /var/log/caddy/plexiq.log

        format json

    }

}

 

# Backend API (optional - can be accessed through frontend proxy)

plexiq-api.oz.alisium.run {

    # Reverse proxy to backend

    reverse_proxy localhost:5000

 

    # CORS headers for API

    @cors_preflight method OPTIONS

    handle @cors_preflight {

        header {

            Access-Control-Allow-Origin "*"

            Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"

            Access-Control-Allow-Headers "Content-Type, Authorization"

            Access-Control-Max-Age "86400"

        }

        respond "" 204

    }

 

    header {

        Access-Control-Allow-Origin "*"

        Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"

        Access-Control-Allow-Headers "Content-Type, Authorization"

    }

 

    # Gzip compression

    encode gzip

 

    # Logging

    log {

        output file /var/log/caddy/plexiq-api.log

        format json

    }

}

 

# Alternative: Single domain with path-based routing

# plexiq.oz.alisium.run {

#     # Frontend

#     handle /* {

#         reverse_proxy localhost:8080

#     }

#

#     # API

#     handle /api/* {

#         reverse_proxy localhost:5000

#     }

#

#     encode gzip

#

#     log {

#         output file /var/log/caddy/plexiq.log

#         format json

#     }

# }

 